Phase,Title,Description
Detection/Analysis,Receive Alert,"Monitor alerts from EY SOC, Darktrace, Microsoft Defender, or internal reports. Access the appropriate incident management system. Create a new incident ticket with the following details: Date and time of alert, Source of alert, Brief description of the potential malware incident. Assign the ticket to the Incident Handler. Notify the Incident Handler via established communication channels (e.g., email, SMS, or phone call)."
Detection/Analysis,Perform Initial Assessment,"Review the alert details in the incident ticket. Assess the potential severity using the Cybersecurity Incident Severity Rating guide: S3 (Low): Minor impact, limited spread, easily containable; S2 (Medium): Moderate impact, potential for spread, requires significant effort to contain; S1 (High): Major impact, widespread infection, critical systems affected. Document the initial severity rating in the incident ticket. If rated S2 or S1, immediately notify the Incident Manager."
Detection/Analysis,Assign Team Members,"Based on the initial severity assessment, identify required team members: S3: Assign SECOPS team members; S2: Engage SECOPS and relevant system owners; S1: Mobilise full Cybersecurity Incident Response Team (CIRT). Use the organisation's on-call roster to identify available personnel. Contact team members via established emergency communication channels. Create a secure communication channel (e.g., Microsoft Teams room) for incident coordination. Schedule an initial briefing call if the severity is S2 or S1. Update the incident ticket with the assigned team members and communication channel details."
Detection/Analysis,Gather Initial Information,"Log into the Azure portal (https://portal.azure.com). Navigate to Microsoft Sentinel. Select the appropriate Sentinel workspace. Click on ""Logs"" in the left menu. In the query window, paste and run the Sentinel queries to identify affected systems and related alerts. Review the results and document findings in the incident ticket."
Detection/Analysis,Review Darktrace Alerts,"Log into the Darktrace portal using secure credentials. Navigate to ""Model Breaches"" in the left menu. Search for affected systems identified in Sentinel. Review associated Model Breaches, focusing on breach types, timestamps, and severity scores. Examine the ""Threat Visualizer"" for a graphical representation of potential malware activity. Document all findings in the incident ticket."
Detection/Analysis,Check Microsoft Defender Status,"Open PowerShell as an administrator on a secure management workstation. Run 'Get-MpComputerStatus' to check Microsoft Defender status. Ensure real-time protection is enabled. For each affected system, run 'Invoke-MpScan -ScanType QuickScan -ComputerName {affected_system}'. Check for detected threats using 'Get-MpThreatDetection'. Document all findings, including scan results and detected threats, in the incident ticket."
Detection/Analysis,Examine Palo Alto Firewall Logs,"Log into the Palo Alto Networks firewall web interface. Navigate to ""Monitor"" > ""Logs"" > ""Traffic"". Filter logs for affected systems' IP addresses or hostnames. Review for suspicious patterns: connections to known malicious IP addresses, unusual outbound connections, high volumes of traffic to unexpected destinations. Check ""Monitor"" > ""Logs"" > ""Threat"" for detected threats. Export relevant log entries for further analysis. Document findings in the incident ticket."
Detection/Analysis,Analyse CrowdStrike Falcon Detections,"Log into the CrowdStrike Falcon console (https://falcon.crowdstrike.com/). Navigate to ""Activity"" > ""Detections"". Filter for server detections within the incident period. Review detections, focusing on severity, MITRE ATT&CK tactics and techniques, and affected servers. Examine detection details, including process trees, command lines, and IoCs. Document all findings in the incident ticket."
Detection/Analysis,Document Findings,"Record all observations, analysis results, and actions taken in the incident ticket. Ensure all relevant information is clearly documented and easily accessible for the incident response team."
Detection/Analysis,Compile Affected Systems List,"Create a comprehensive list of all systems impacted by the malware incident. Include details such as system names, IP addresses, affected services, and associated malware alerts or threats for each system."
Detection/Analysis,Prepare Initial Summary,"Compile a concise summary of all findings, including affected systems, malware characteristics, potential impact, and recommended next steps. Present this summary to the Incident Handler for review and further action."
Detection/Analysis,Identify Malware Strain,"Upload suspicious files to VirusTotal (https://www.virustotal.com/). Analyse the results, noting detection ratios, file characteristics, and identified malware families. Document findings in the incident ticket."
Detection/Analysis,Submit Sample to CrowdStrike Sandbox,"Submit malware samples to CrowdStrike Falcon Sandbox. Configure analysis options appropriate for the suspected malware type. Review the sandbox report, focusing on malware classification, observed behaviours, and indicators of compromise (IoCs). Document analysis results in the incident ticket."
Detection/Analysis,Conduct Microsoft Defender Analysis,"Use PowerShell to run in-depth Microsoft Defender analysis on affected systems. Execute commands such as 'Get-MpThreatDetection | Where-Object ThreatID -eq ""{malware_id}"" | Format-List' for detailed threat information. Analyse outputs for initial detection times, affected resources, and threat characteristics. Record findings in the incident ticket."
Detection/Analysis,Perform Darktrace Analysis,"Access the Darktrace portal and navigate to relevant Model Breaches. Analyse the breach descriptions, similar breaches, and connections over time graphs. Use the Threat Visualizer to examine the device's activity timeline, noting unusual connections, data transfers, and potential command and control (C2) indicators. Document all observations in the incident ticket."
Detection/Analysis,Execute CrowdStrike Falcon Analysis,"Utilise CrowdStrike Falcon's advanced analysis features. Review process trees, command lines, and affected files for each detection. Use Real-time Response for deeper analysis, including memory dumps and file information gathering. Investigate potential lateral movement using the Process Explorer and Host Search features. Export relevant IoCs and generate a comprehensive Detection Report. Document all findings in the incident ticket."
Detection/Analysis,Correlate Findings,"Compare and contrast findings from all analysis tools. Identify common indicators, behaviours, and affected systems across different platforms. Research the identified malware family using reputable sources such as MITRE ATT&CK, CISA alerts, and vendor threat reports. Synthesise all information to form a comprehensive understanding of the malware and its impact."
Detection/Analysis,Update CIRT Report,"Prepare a detailed CIRT (Cybersecurity Incident Response Team) report. Include sections on identified malware strains, key characteristics and behaviours, potential impact on systems and data, initial infection vector (if identified), list of all affected systems, and a comprehensive list of IoCs. Summarise findings and update the incident ticket. Share the report with the Incident Manager and relevant team members."
Containment,Isolate Affected Systems,"Log into the CrowdStrike Falcon console. Navigate to ""Hosts"" > ""Host Management"". Locate and select the affected server(s). Use the ""Actions"" > ""contain"" feature to isolate compromised servers. Monitor the containment status and document actions in the incident ticket."
Containment,Implement SCCM Isolation,"Open the SCCM console. Navigate to ""Assets and Compliance"" > ""Devices"". Locate affected systems and use the ""Client Notification"" > ""Disable Network Access"" option to isolate them. Verify isolation using PowerShell commands. Document actions in the incident ticket."
Containment,Secure Azure VMs,Access the Azure Portal. Navigate to the affected VM's Network Security Group (NSG). Add new inbound and outbound security rules to isolate the VM. Apply changes and verify isolation using PowerShell commands. Document all actions in the incident ticket.
Containment,Activate Darktrace Antigena,"Log into the Darktrace portal. Navigate to ""Antigena"" > ""Active Threats"". For each affected device, review suggested Antigena actions and implement appropriate responses (e.g., ""Enforce Pattern of Life"" or ""Block""). Confirm actions and document in the incident ticket."
Containment,Update Palo Alto Firewall Rules,"Access the Palo Alto Networks firewall interface. Create a new security rule to isolate affected systems: set source to affected IPs, destination to Any, and action to Deny. Place the rule at the top of the rule list. Commit changes and verify effectiveness. Document actions in the incident ticket."
Containment,Block Malicious URLs,"In the Palo Alto Networks firewall interface, create a new URL category for identified malicious URLs. Update security policies to block this category. Commit changes and verify the block is effective. Document actions in the incident ticket."
Containment,Block Malicious IPs in Prisma Cloud,"Log into Prisma Cloud console. Navigate to ""Defend"" > ""Network"". Create a new rule to block identified malicious IPs. Set appropriate severity and action settings. Save the rule and monitor for alerts. Document actions in the incident ticket."
Containment,Configure Microsoft Defender Blocks,Use PowerShell to add malicious URL indicators to Microsoft Defender. Run 'New-MpIndicator' commands for each malicious URL. Verify indicators are added using 'Get-MpIndicator'. Document actions in the incident ticket.
Containment,Disable Compromised On-Premises Accounts,Use PowerShell to disable compromised on-premises AD accounts. Run 'Disable-ADAccount' for each affected account. Verify using 'Get-ADUser' command. Document actions in the incident ticket.
Containment,Disable Compromised Azure AD Accounts,Connect to Azure AD via PowerShell. Use 'Set-AzureADUser' cmdlet to disable compromised accounts. Verify account status using 'Get-AzureADUser'. Document actions in the incident ticket.
Containment,Review Account Activity,"Access Azure AD Admin Center. Review sign-in activities and audit logs for compromised accounts. Look for suspicious locations, devices, or unauthorised activities. Document findings in the incident ticket."
Containment,Reset Multi-Factor Authentication,"In Azure AD Admin Center, navigate to the user's profile. Use the ""Reset multi-factor authentication"" option under ""Authentication methods"". Follow prompts to reset MFA for affected users. Document actions in the incident ticket."
Containment,Revoke Active Sessions,"In Azure AD Admin Center, go to the user's profile. Under ""Sessions"", review all active sessions. Use the ""Revoke all sessions"" option to force sign-out on all devices for compromised accounts. Document actions in the incident ticket."
Containment,Review OAuth Consent Grants,"In Azure AD, go to ""Enterprise applications"". Review the list for any suspicious applications associated with compromised accounts. Remove any unauthorised application access. Document actions in the incident ticket."
Containment,Provide Status Updates,"Prepare a status update using the CIRT Communication / Reporting Requirements template. Include current incident status, affected systems/accounts, implemented containment measures, ongoing activities, and next steps. Distribute to relevant stakeholders and schedule the next update. Document communication in the incident ticket."
Eradication,Remove Malware via CrowdStrike,"Log into CrowdStrike Falcon console. Use Real Time Response (RTR) to run commands for identifying, analysing, and removing malicious files on affected servers. Conduct full scans post-removal. Document all actions and results in the incident ticket."
Eradication,Eliminate Malware with Microsoft Defender,Use PowerShell to run full system scans with Microsoft Defender on affected systems. Execute 'Start-MpScan -ScanType FullScan' and monitor progress. Remove detected threats using 'Remove-MpThreat'. Verify removal with 'Get-MpThreatDetection'. Document all actions and results in the incident ticket.
Eradication,Perform Manual Malware Removal,Boot affected systems in Safe Mode with Networking. Manually delete identified suspicious files. Remove malicious registry entries using regedit. Check and remove suspicious scheduled tasks and startup items. Document all actions taken in the incident ticket.
Eradication,Verify Malware Removal,Use additional malware removal tools like Malwarebytes and ESET Online Scanner to verify complete malware removal. Run full system scans with these tools. Document scan results and any additional threats removed in the incident ticket.
Eradication,Check for Remaining IoCs,"Review all identified Indicators of Compromise (IoCs) from the analysis phase. Verify that each IoC has been addressed during the eradication process. This may include checking for specific files, registry keys, or network connections. Document the status of each IoC in the incident ticket."
Eradication,Monitor for Persistent Threats,"Continuously monitor affected systems for any signs of persistent malware activity. This may include watching for unexpected network connections, unusual process behaviour, or system performance issues. Use tools like Process Explorer or TCPView for detailed system monitoring. Document any suspicious activities in the incident ticket."
Eradication,Conduct Vulnerability Scan,Log into Qualys Cloud Platform. Create a new scan targeting all affected and related systems. Configure the scan to include all QIDs. Run the scan and generate a report focusing on critical and high vulnerabilities. Document the scan results in the incident ticket.
Eradication,Prioritise Vulnerabilities,"Review the Qualys vulnerability report. Prioritise vulnerabilities based on severity, exploitability, and relevance to the recent incident. Create a patching plan considering system criticality, potential downtime, and dependencies. Document the prioritisation and patching plan in the incident ticket."
Eradication,Document Malware Removal,"For each affected system, record: System name and function, Malware components removed, Methods used for removal, Results of verification scans. Update the incident ticket with a summary of all eradication actions taken."
Eradication,Apply Patches via SCCM,Open the SCCM console. Navigate to Software Updates. Filter for required updates based on the Qualys report. Deploy these updates to affected systems. Set appropriate installation deadlines. Monitor the deployment status in SCCM. Document the patching process and results in the incident ticket.
Eradication,Patch Azure VMs,Log into Azure Portal. Use Azure Update Management to schedule and deploy necessary patches to affected Azure VMs. Configure the deployment based on the Qualys report findings. Monitor the update process. Document all actions and results in the incident ticket.
Eradication,Update Applications,"Identify all applications needing updates from the Qualys report. For each application: Download the latest version, test in a non-production environment, deploy using standard procedures, verify functionality post-update. Document all update actions and results in the incident ticket."
Eradication,Verify Patching Effectiveness,Re-run Qualys vulnerability scans on all patched systems. Compare results with the initial scan to confirm successful patching. Address any remaining vulnerabilities. Update the incident ticket with the final patching results.
Eradication,Revise Group Policies,"Open Group Policy Management Console. Review and update security-related settings for affected systems. This may include password policies, account lockout policies, and application restrictions. Create a new GPO for post-incident hardening if necessary. Test and apply updated policies. Document all changes in the incident ticket."
Eradication,Optimise Azure Security Center,"Log into Azure Portal. Navigate to Security Center. Review all recommendations, focusing on Compute & Apps, Networking, and Identity & Access. Implement relevant recommendations. Enable additional Security Center features if necessary. Document all changes and implementations in the incident ticket."
Eradication,Fine-tune Darktrace Models,Log into Darktrace portal. Adjust 'Patterns of Life' models based on incident learnings. This may include lowering thresholds for behaviours similar to the attack or creating custom models for specific attack patterns observed. Update device labels and importance ratings if necessary. Document all adjustments in the incident ticket.
Eradication,Enhance Palo Alto Firewall Policies,Log into Palo Alto Networks firewall interface. Review and update existing security rules based on the incident. Implement least-privilege access principles. Create rules to explicitly block identified IoCs. Update application filters and enhance threat prevention profiles. Implement or update DNS sinkholing if relevant. Document all changes in the incident ticket.
Eradication,Strengthen CrowdStrike Falcon Settings,Log into CrowdStrike Falcon console. Review and update prevention policies. Enable additional prevention features and lower thresholds for suspicious activities based on the incident findings. Create custom Indicators of Attack (IOAs) related to the incident. Adjust machine learning model sensitivity levels. Enhance visibility settings for relevant event types. Document all changes in the incident ticket.
Recovery,Assess Restoration Requirements,Review the extent of the malware infection and determine which systems require restoration from backups. Prioritise critical systems for restoration. Document the assessment and prioritisation in the incident ticket.
Recovery,Restore from Backups,"Access your backup solution (e.g., Veeam for on-premises systems). For each affected system, locate the latest clean backup prior to the infection. Initiate the restoration process following established procedures. Monitor restoration progress. Document all restoration actions in the incident ticket."
Recovery,Recover Azure VMs,"Log into Azure Portal. Navigate to ""Backup"" service. For each affected Azure VM, initiate the restore process using the latest clean snapshot. Monitor the restoration job progress. Document all restoration actions in the incident ticket."
Recovery,Verify Data Integrity,For each restored system: Boot in a segregated network environment. Run full system scans using CrowdStrike Falcon (for servers) or Microsoft Defender (for workstations). Check critical system files and applications for any signs of tampering. Verify all expected data and configurations are present. Document all verification steps and results in the incident ticket.
Recovery,Document Restoration Actions,"For each restored system, record: System name and function, Date and time of restoration, Backup source and date used, Any issues encountered during restoration, Results of integrity checks. Update the incident ticket with a summary of all restoration actions."
Recovery,Perform CrowdStrike Scans,"Log into CrowdStrike Falcon console. Navigate to ""Hosts"" > ""Host Management"". Select restored servers and initiate full system scans. Monitor scan progress and results in the console. Document all scan results in the incident ticket."
Recovery,Execute Microsoft Defender Scans,Use PowerShell to run full system scans on restored workstations using Microsoft Defender. Execute 'Start-MpScan -ScanType FullScan' and monitor progress with 'Get-MpScanResult'. Document all scan results in the incident ticket.
Recovery,Conduct Post-Recovery Vulnerability Scan,Log into Qualys platform. Create and run a comprehensive scan targeting all restored systems. Generate a report analysing for any critical vulnerabilities or unexpected open ports. Compare results with pre-incident baselines. Document all findings in the incident ticket.
Recovery,Review Darktrace for Anomalies,"Log into Darktrace portal. Set the time range to cover the period since system restoration. Filter for restored systems and review any detected anomalies. Pay special attention to unusual network connections, unexpected data transfers, or any behaviour similar to the initial infection. Document all findings in the incident ticket."
Recovery,Examine Palo Alto Firewall Logs,"Log into Palo Alto Networks firewall interface. Review traffic logs for restored systems. Look for connections to unknown or suspicious IP addresses, unusual outbound traffic patterns, or any blocked traffic that might indicate residual malware activity. Document all findings in the incident ticket."
Recovery,Verify Critical Services,For each restored system: Check that all expected services are running. Test critical applications for functionality. Verify database integrity if applicable. Ensure all necessary network connections are established and secure. Document the status of each critical service and application in the incident ticket.
Recovery,Compile Recovery Report,"Compile a comprehensive recovery report including: Results of all scans and checks performed, Any anomalies or issues discovered, Actions taken to address any found issues, Overall integrity status of each restored system. Update the incident ticket with a summary of the integrity verification process."
Recovery,Plan Service Re-enablement,Review the list of isolated systems and disabled accounts. Create a prioritised list for re-enablement based on business criticality. Establish a monitoring plan for each system/account as it's re-enabled. Document the re-enablement plan in the incident ticket.
Recovery,Re-enable Systems in CrowdStrike,"Log into CrowdStrike Falcon console. Navigate to ""Hosts"" > ""Host Management"". Select the isolated hosts and use the ""Actions"" > ""Lift containment"" feature."
Recovery,Restore Network Access via SCCM,"Open the SCCM console. Navigate to ""Assets and Compliance"" > ""Devices"". Locate the isolated systems and use the ""Client Notification"" > ""Enable Network Access"" option. Verify network access is restored. Document actions in the incident ticket."
Recovery,Re-enable Azure VM Connectivity,Log into Azure Portal. Navigate to the VM's Network Security Group. Remove or disable the isolation rules added during containment. Use PowerShell to verify connectivity: Test-NetConnection -ComputerName [VM_IP] -Port 3389. Document actions in the incident ticket.
Recovery,Reactivate On-Premises AD Accounts,"Open PowerShell as administrator. For each affected on-premises AD account, run: Enable-ADAccount -Identity ""username"" and Set-ADUser -Identity ""username"" -ChangePasswordAtLogon $true. Verify actions and document in the incident ticket."
Recovery,Restore Azure AD Accounts,"Connect to Azure AD using PowerShell. For each affected Azure AD account, run: Set-AzureADUser -ObjectID ""user@ahpra.gov.au"" -AccountEnabled $true and Set-AzureADUser -ObjectID ""user@ahpra.gov.au"" -ForceChangePasswordNextLogin $true. Verify actions and document in the incident ticket."
Recovery,Implement Enhanced Monitoring,"In CrowdStrike Falcon, create new custom rules to monitor for suspicious activities on re-enabled systems. In Microsoft Sentinel, set up scheduled query rules to monitor login activities and critical events for re-enabled accounts/systems. In Darktrace, create custom models for monitoring re-enabled systems/accounts with lower alert thresholds. Document all new monitoring measures in the incident ticket."
Recovery,Document Re-enablement Process,"For each re-enabled system/account, record: Name/identifier, Date and time of re-enablement, Any immediate issues observed, Confirmation of forced password change (for accounts). Update the incident ticket with a summary of re-enablement actions and status."
Recovery,Configure Sentinel Monitoring,"In Microsoft Sentinel, create a new scheduled query rule to monitor for potential reinfection. Set up queries to detect suspicious activities related to the recent incident. Configure the query to run at regular intervals and set up appropriate alert actions. Document the monitoring setup in the incident ticket."
Recovery,Set Up Darktrace Monitoring,"Log into Darktrace portal. Create a new model named ""Post-Incident Monitoring - [DATE]"". Define the model scope to include all previously affected systems. Set up specific behavioural rules based on the characteristics of the previous infection. Configure alerting thresholds to be more sensitive than standard models. Enable real-time alerting for any matches to this model. Document the setup in the incident ticket."
Recovery,Establish Palo Alto Monitoring,"Log into Palo Alto Networks firewall interface. Create a new security policy rule named ""Monitor-Post-Incident-[DATE]"". Configure the rule to monitor traffic related to the recent incident. Create custom spyware signatures based on the IOCs from the incident. Apply these signatures to the new security policy. Configure logging and alerting for any matches. Document the setup in the incident ticket."
Recovery,Initiate CrowdStrike Monitoring,"Log into CrowdStrike Falcon console. Create a new custom Indicator of Attack (IOA) named ""Post-Incident-Monitoring-[DATE]"". Include details of the previous incident in the description. Set severity to High and select all applicable platforms. Define conditions based on the behaviour observed in the previous incident. Set the action to ""Detect"". Apply this custom IOA to all previously affected systems. Configure real-time notifications for any detections related to this IOA. Document the setup in the incident ticket."
Recovery,Organise Regular Reviews,"Schedule daily review meetings for the first week post-incident. Assign team members to review logs and alerts from Microsoft Sentinel, Darktrace, Palo Alto Firewalls, and CrowdStrike Falcon. Create a shared document to log any suspicious activities or potential indicators of reinfection. Establish an escalation process for any significant findings. Document the review schedule and process in the incident ticket."
Recovery,Finalise Monitoring Documentation,"Create a comprehensive document detailing: All custom rules, models, and alerts created, Systems and accounts under enhanced monitoring, Review schedule and responsible team members, Escalation procedures. Update the incident ticket with a summary of the monitoring setup and link to the detailed document."
